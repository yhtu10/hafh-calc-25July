<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>HafH Taiwan 2025 首月 3 折活動計算機</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Noto Sans TC', 'Segoe UI', Arial, 'Microsoft JhengHei', sans-serif;
      background: #f6f6f8;
      color: #342d3e;
      margin: 0;
    }
    .main {
      max-width: 480px;
      margin: 0 auto;
      padding: 32px 0 40px 0;
    }
    h1 {
      font-size: 2.1em;
      font-weight: 700;
      letter-spacing: 0.5px;
      color: #342d3e;
      text-align: center;
      margin: 30px 0 10px 0;
      line-height: 1.2;
    }
    .subnote-block {
      background: #fff;
      border-radius: 14px;
      box-shadow: 0 2px 12px #0001;
      padding: 13px 19px 13px 19px;
      margin: 0 auto 24px auto;
      font-size: 1em;
      color: #7149ce;
      max-width: 360px;
    }
    .subnote-block ul {
      margin: 0;
      padding-left: 1.3em;
      line-height: 1.7;
    }
    .info-block {
      background: #fff;
      border-radius: 14px;
      box-shadow: 0 2px 12px #0001;
      max-width: 380px;
      margin: 0 auto 18px auto;
      padding: 20px 20px 20px 24px;
      line-height: 1.7;
    }
    .info-title {
      font-size: 1.25em;
      font-weight: 700;
      margin: 0 0 4px 0;
      color: #342d3e;
      letter-spacing: 0.3px;
    }
    .info-sub {
      font-size: 1em;
      color: #9b93a3;
      font-weight: 400;
      margin-bottom: 7px;
      margin-top: 1px;
    }
    .info-table {
      margin: 8px 0 8px 0;
      font-size: 1.08em;
      color: #342d3e;
      font-weight: 400;
      letter-spacing: 0.3px;
    }
    .info-hint-yellow {
      color: #342d3e;
      background: #f6f6f8;
      font-size: 0.98em;
      margin-top: 2px;
      margin-bottom: 8px;
    }
    .info-hint-purple {
      color: #7149ce;
      font-size: 0.98em;
      margin-top: 2px;
      margin-bottom: 8px;
    }
    .input-card {
      background: #fff;
      margin: 18px auto 18px auto;
      padding: 22px 18px 18px 18px;
      max-width: 340px;
      border-radius: 12px;
      box-shadow: 0 3px 24px #0001;
      text-align: left;
    }
    .input-card label {
      font-size: 1.04em;
      font-weight: 500;
      margin-bottom: 1px;
      margin-top: 14px;
      display: block;
      color: #342d3e;
    }
    .input-card input[type="number"] {
      width: 98%;
      font-size: 1em;
      padding: 7px 8px;
      border: 1px solid #b9b5c2;
      border-radius: 8px;
      outline: none;
      background: #f6f6f8;
      margin-bottom: 8px;
      color: #342d3e;
      box-sizing: border-box;
    }
    .input-card input[type="number"]::placeholder {
      color: #b9b5c2;
      font-size: 1em;
      opacity: 1;
    }
    .input-card button {
      background: #7149ce;
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 1.12em;
      font-weight: 700;
      padding: 11px 0;
      width: 100%;
      margin-top: 18px;
      cursor: pointer;
      transition: background .16s;
      letter-spacing: 1px;
    }
    .input-card button:hover { background: #342d3e; }
    #output {
      margin: 22px auto 0 auto;
      max-width: 480px;
      text-align: left;
    }
    .result-block {
      background: #fff;
      border-radius: 14px;
      box-shadow: 0 2px 8px #0001;
      margin: 22px auto 18px auto;
      padding: 24px 23px 18px 23px;
      min-width: 0;
    }
    .result-block h3 {
      font-size: 1.25em;
      font-weight: 700;
      margin: 0 0 10px 0;
      color: #342d3e;
      letter-spacing: 0.5px;
    }
    .result-block ul {
      margin: 0 0 14px 0;
      padding-left: 1.3em;
      font-size: 1.08em;
      color: #342d3e;
      line-height: 1.8;
    }
    .result-summary {
      background: #f8f8fa;
      border-radius: 12px;
      border: 2px solid #f0e179;
      padding: 16px 10px 12px 14px;
      margin-top: 14px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      font-size: 1.05em;
    }
    .cost-label {
      color: #342d3e;
      font-weight: 500;
      font-size: 1em;
      margin-right: 6px;
    }
    .cost {
      font-size: 1.4em;
      font-weight: 700;
      color: #342d3e;
      margin-right: 16px;
    }
    .percent {
      font-size: 1.18em;
      font-weight: 700;
      margin-left: 12px;
      margin-top: 4px;
    }
    .percent-lower { color: #7149ce; }
    .percent-higher { color: #f96983; }
    .cta-block {
      background: #fff;
      border: 2px solid #1dbace;
      border-radius: 12px;
      margin: 18px auto 14px auto;
      max-width: 440px;
      padding: 18px 20px;
      text-align: left;
      font-size: 1.12em;
      color: #342d3e;
      line-height: 1.7;
    }
    .cta-block a {
      color: #7149ce;
      font-weight: 700;
      text-decoration: underline;
    }
    .footer-note {
      background: #fff;
      margin: 35px auto 0 auto;
      max-width: 460px;
      border-radius: 13px;
      box-shadow: 0 3px 18px #0001;
      padding: 14px 18px 14px 22px;
      color: #7d7485;
      font-size: 0.99em;
      text-align: left;
      line-height: 1.7;
    }
    @media (max-width: 540px) {
      .main { padding: 10px 0 26px 0;}
      .subnote-block { padding: 11px 3vw 11px 3vw; font-size:0.97em;}
      .info-block { max-width:99vw; padding:15px 3vw 18px 4vw;}
      .input-card { padding: 17px 2vw 13px 2vw;}
      .result-block { padding: 19px 2vw 15px 2vw; }
      .footer-note { padding: 11px 6px 11px 8px;}
      .cta-block {padding: 13px 2vw;}
    }
  </style>
</head>
<body>
  <div class="main">
    <h1>HafH Taiwan 2025<br>首月 3 折活動計算機</h1>
    <div class="subnote-block">
      <ul>
        <li>新會員預設使用邀請碼加入，即帳戶有 300 Ⓗ，所有計算以此為前提。</li>
        <li>請輸入與官方網站相同條件的金額（如日期、人數、取消規則），且皆為新台幣。</li>
        <li>用戶自製小工具，可能有 bug，僅供參考。</li>
      </ul>
    </div>
    <div class="info-block">
      <div class="info-title">新手包</div>
      <div class="info-sub">（限新會員首次註冊，各組限購 1 次）</div>
      <div class="info-table">
        100 Ⓗ　NT$720（9折優惠）<br>
        300 Ⓗ　NT$2,040（85折優惠）<br>
        600 Ⓗ　NT$3,840（8折優惠）
      </div>
      <div class="info-hint-purple">
        新手包僅在新會員付費加入後，7/28 前可購買，各組限購一次。
      </div>
      <div class="info-title" style="margin-top:22px;">指定代幣組合</div>
      <div class="info-sub">（不限次數，付費會員皆可購買）</div>
      <div class="info-table">
        200 Ⓗ　NT$1,440（9折優惠）
      </div>
      <div class="info-hint-purple">
        指定代幣組合可購買直到帳號上限，7/28 前隨時可購買。
      </div>
    </div>
    <form class="input-card" onsubmit="showResult(); return false;">
      <label>HafH 所需 Ⓗ 數：</label>
      <input id="hafhHC" type="number" placeholder="請輸入數字，例如 500">
      <label>官網價格（NT$）：</label>
      <input id="officialPrice" type="number" placeholder="請輸入數字，例如 7000">
      <button type="submit">計算</button>
    </form>
    <div id="output"></div>
    <div class="cta-block">
      💡 現在立即使用
      <a href="https://www.hafh.com/zh-tw/invite/tw/EDXTKX?utm_source=calculator&utm_medium=yh&utm_campaign=tw70off" target="_blank">
        我的邀請連結
      </a>
      完成付費加入，享有首月 3 折與邀請禮遇 100 Ⓗ 優惠開始累積！
    </div>
    <div class="footer-note">
      1. 此試算頁面為粗略估算，為求謹慎請自行依照機制再多次試算一遍。<br>
      2. 付費加入當天為結算日，且為第一次扣款。到第三次扣款時帳號會升級為 Silver VIP，享有每筆訂房 95 折。<br>
      3. 有預約的狀況下無法變更為休眠會籍。若有跨月則需考慮是否經過結算日。如和朋友同時有約 200 Ⓗ 入帳。
    </div>
  </div>
  <script>
    // 代幣組合設定
    const starterPacks = [
      { qty: 600, price: 3840 },
      { qty: 300, price: 2040 },
      { qty: 100, price: 720 }
    ];
    const regularPack = { qty: 200, price: 1440 };

    // 用於自動組合最省錢的購買方式，回傳 [{qty, price, type, count}]
    function getTokenPurchasePlan(diff, allowStarter=true) {
      if (diff <= 0) return [];
      // 新手包只能各買一次，指定組合不限
      const packs = allowStarter
        ? [
            { type: 'starter', qty: 100, price: 720, max: 1 },
            { type: 'starter', qty: 300, price: 2040, max: 1 },
            { type: 'starter', qty: 600, price: 3840, max: 1 },
            { type: 'regular', qty: 200, price: 1440, max: 99 }
          ]
        : [
            { type: 'regular', qty: 200, price: 1440, max: 99 }
          ];
      let maxToken = diff + 600;
      let cost = Array(maxToken+1).fill(Infinity);
      let path = Array(maxToken+1).fill(null);
      cost[0] = 0;
      path[0] = [];
      // 新手包部分用 0/1 背包法
      for (let s100 = allowStarter ? 0 : 1; s100 <= (allowStarter ? 1 : 0); ++s100)
      for (let s300 = allowStarter ? 0 : 1; s300 <= (allowStarter ? 1 : 0); ++s300)
      for (let s600 = allowStarter ? 0 : 1; s600 <= (allowStarter ? 1 : 0); ++s600) {
        let tokens = 100 * s100 + 300 * s300 + 600 * s600;
        let amount = 720 * s100 + 2040 * s300 + 3840 * s600;
        for (let r = 0; r <= Math.ceil(maxToken/200); ++r) {
          let totalTokens = tokens + 200 * r;
          let totalAmount = amount + 1440 * r;
          if (totalTokens >= diff && totalTokens <= maxToken) {
            if (totalAmount < cost[totalTokens]) {
              cost[totalTokens] = totalAmount;
              path[totalTokens] = [
                { type: 'starter', qty: 100, price: 720, count: s100 },
                { type: 'starter', qty: 300, price: 2040, count: s300 },
                { type: 'starter', qty: 600, price: 3840, count: s600 },
                { type: 'regular', qty: 200, price: 1440, count: r }
              ].filter(p => p.count > 0 && (allowStarter || p.type === 'regular'));
            }
          }
        }
      }
      // 找到最省錢的可 cover diff 組合
      let min = Infinity, minPlan = null;
      for (let t = diff; t <= maxToken; ++t) {
        if (cost[t] < min) {
          min = cost[t];
          minPlan = path[t];
        }
      }
      return minPlan || [];
    }

    function format(num) {
      return "NT$" + num.toLocaleString();
    }
    function formatPercent(num) {
      return (num*100).toFixed(1) + "%";
    }
    function percentClass(val) {
      return val < 1 ? "percent percent-lower" : "percent percent-higher";
    }

    function showResult() {
      const hafhHC = parseInt(document.getElementById('hafhHC').value, 10);
      const officialPrice = parseInt(document.getElementById('officialPrice').value, 10);
      if (isNaN(hafhHC) || isNaN(officialPrice) || hafhHC <= 0 || officialPrice <= 0) {
        document.getElementById('output').innerHTML = '<div style="color:#d00;padding:1.5em 0;font-weight:bold;text-align:center;">請正確輸入所需 HafH 代幣與官網價格</div>';
        return;
      }
      // 方案 A：一人申辦新會員
      let diffA = Math.max(0, hafhHC - 300);
      let purchaseA = getTokenPurchasePlan(diffA, true);
      let totalCostA = 439;
      let purchaseStrA = purchaseA.length > 0
        ? purchaseA.map(p =>
          (p.type==='starter' ? "新手包 " : "指定代幣組合 ") + p.qty + " Ⓗ ×" + p.count + "（" + format(p.price * p.count) + "）"
        ).join("； ")
        : "無需加購";
      totalCostA += purchaseA.reduce((sum, p) => sum + p.price * p.count, 0);
      let percentA = totalCostA / officialPrice;
      let percentStrA = "約為 <b>" + formatPercent(percentA) + "</b>";

      // 方案 B：兩人同時新會員（分攤預訂）
      let perPerson = Math.ceil(hafhHC/2);
      let diffB = Math.max(0, perPerson - 300);
      let purchaseB = getTokenPurchasePlan(diffB, true);
      let totalCostB = 439*2;
      let purchaseStrB = purchaseB.length > 0
        ? purchaseB.map(p =>
          (p.type==='starter' ? "新手包 " : "指定代幣組合 ") + p.qty + " Ⓗ ×" + p.count + "（" + format(p.price * p.count) + "）"
        ).join("； ")
        : "無需加購";
      totalCostB += purchaseB.reduce((sum, p) => sum + p.price * p.count, 0) * 2;
      let percentB = totalCostB / officialPrice;
      let percentStrB = "約為 <b>" + formatPercent(percentB) + "</b>";

      // 方案 C：舊會員邀請朋友一起住
      // 舊會員只能買 regular，朋友是新會員可用 starter
      let diffCOld = perPerson;
      let purchaseCOld = getTokenPurchasePlan(diffCOld, false);
      let totalCostCOld = purchaseCOld.reduce((sum, p) => sum + p.price * p.count, 0);
      let purchaseStrCOld = purchaseCOld.length > 0
        ? purchaseCOld.map(p =>
          "指定代幣組合 " + p.qty + " Ⓗ ×" + p.count + "（" + format(p.price * p.count) + "）"
        ).join("； ")
        : "無需加購";
      let diffCNew = perPerson - 300;
      let purchaseCNew = getTokenPurchasePlan(diffCNew, true);
      let totalCostCNew = 439;
      let purchaseStrCNew = purchaseCNew.length > 0
        ? purchaseCNew.map(p =>
          (p.type==='starter' ? "新手包 " : "指定代幣組合 ") + p.qty + " Ⓗ ×" + p.count + "（" + format(p.price * p.count) + "）"
        ).join("； ")
        : "無需加購";
      totalCostCNew += purchaseCNew.reduce((sum, p) => sum + p.price * p.count, 0);
      let totalCostC = totalCostCOld + totalCostCNew;
      let percentC = totalCostC / officialPrice;
      let percentStrC = "約為 <b>" + formatPercent(percentC) + "</b>";

      // 組裝
      let html = '';
      html += `
        <div class="result-block">
          <h3>方案 A｜一人申辦新會員</h3>
          <ul>
            <li>帳號開局為 300 Ⓗ</li>
            <li>實際需要 ${hafhHC} Ⓗ，差額 ${diffA} Ⓗ</li>
            <li>新會員加購：${purchaseStrA}</li>
            <li>首月會費：${format(439)}</li>
          </ul>
          <div class="result-summary">
            <span><span class="cost-label">總成本：</span><span class="cost">${format(totalCostA)}</span></span>
            <span><span class="cost-label">您輸入的官網價：</span><span class="cost">${format(officialPrice)}</span></span>
            <span class="${percentA<1?'percent-lower':'percent-higher'}">${percentStrA}</span>
          </div>
        </div>
        <div class="result-block">
          <h3>方案 B｜兩人同時申辦新會員（分攤預訂）</h3>
          <ul>
            <li>房價 ${hafhHC} Ⓗ 拆半每人需 ${perPerson} Ⓗ</li>
            <li>新會員各自加購：${purchaseStrB}</li>
            <li>每人首月會費：${format(439)}</li>
          </ul>
          <div class="result-summary">
            <span><span class="cost-label">總成本：</span><span class="cost">${format(totalCostB)}</span></span>
            <span><span class="cost-label">您輸入的官網價：</span><span class="cost">${format(officialPrice)}</span></span>
            <span class="${percentB<1?'percent-lower':'percent-higher'}">${percentStrB}</span>
          </div>
        </div>
        <div class="result-block">
          <h3>方案 C｜舊會員邀請朋友一起住</h3>
          <ul>
            <li>舊會員與朋友各需 ${perPerson} Ⓗ</li>
            <li>舊會員加購：${purchaseStrCOld}</li>
            <li>新會員加購：${purchaseStrCNew}</li>
            <li>朋友首月加入月費：${format(439)}</li>
          </ul>
          <div class="result-summary">
            <span><span class="cost-label">總成本：</span><span class="cost">${format(totalCostC)}</span></span>
            <span><span class="cost-label">您輸入的官網價：</span><span class="cost">${format(officialPrice)}</span></span>
            <span class="${percentC<1?'percent-lower':'percent-higher'}">${percentStrC}</span>
          </div>
        </div>
      `;
      document.getElementById('output').innerHTML = html;
    }
  </script>
</body>
</html>
