<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>HafH 2025 é¦–æœˆ 3 æŠ˜æ´»å‹•è¨ˆç®—æ©Ÿ</title>
  <style>
    body { font-family: "Noto Sans TC", sans-serif; padding: 20px; background: #f9f9f9; }
    h1 { color: #333; }
    label { display: block; margin-top: 10px; }
    input { margin-bottom: 10px; padding: 5px; width: 200px; }
    button { padding: 10px 20px; background-color: #4CAF50; color: white; border: none; cursor: pointer; }
    .intro { margin: 18px 0 26px 0; color: #444; }
    .pack-info { background: #fff; padding: 16px; border-radius: 6px; margin: 10px 0 28px 0; line-height: 1.6; font-size: 15px;}
    .pack-info strong { color: #1a73e8; }
    .result { margin-top: 28px; background: #fff; padding: 22px; border-radius: 8px; box-shadow: 0 0 5px rgba(0,0,0,0.08); }
    .footer { font-size: 0.96em; color: #666; margin-top: 36px; line-height: 1.7; }
    .highlight { color: #1a73e8; font-weight: bold; }
    .cost { color: #b71c1c; font-weight: bold; }
    ul { margin: 0 0 10px 0; padding-left: 22px; }
  </style>
  <script>
    // æ–°æ‰‹åŒ…èˆ‡æŒ‡å®šä»£å¹£çµ„åˆ
    const packs = [
      { label: "æ–°æ‰‹åŒ… 100 â’½", hc: 100, cost: 720, type: "starter" },
      { label: "æ–°æ‰‹åŒ… 300 â’½", hc: 300, cost: 2040, type: "starter" },
      { label: "æ–°æ‰‹åŒ… 600 â’½", hc: 600, cost: 3840, type: "starter" },
      { label: "æŒ‡å®šä»£å¹£çµ„åˆ 200 â’½", hc: 200, cost: 1440, type: "extra" }
    ];
    function getMinCostPackage(diff) {
      // æ–°æ‰‹åŒ…åªèƒ½å„è²·ä¸€æ¬¡ã€æŒ‡å®šçµ„åˆå¯ç„¡é™è²·
      let best = null;
      function search(remain, combo, bought, total) {
        if (remain <= 0) {
          if (!best || total < best.total) best = { combo: [...combo], total };
          return;
        }
        for (let p of packs) {
          if (p.type === "starter" && bought[p.label]) continue;
          combo.push(p);
          let nbought = { ...bought };
          if (p.type === "starter") nbought[p.label] = true;
          search(remain - p.hc, combo, nbought, total + p.cost);
          combo.pop();
        }
      }
      search(diff, [], {}, 0);
      let packMap = {};
      for (let p of best.combo) packMap[p.label] = (packMap[p.label] || 0) + 1;
      return { packMap, total: best.total };
    }
    function formatCurrency(num) {
      return "NT$" + num.toLocaleString();
    }
    function getDiscount(cost, price) {
      let fold = Math.round((cost / price) * 10) / 10; // 0.6 -> 6 æŠ˜
      if (fold < 0.1) fold = 0.1;
      return `ç´„ç‚ºå®˜ç¶²åƒ¹æ ¼ ${fold} æŠ˜`;
    }
    function showResult() {
      const hafhHC = parseInt(document.getElementById("hafhHC").value);
      const officialPrice = parseInt(document.getElementById("officialPrice").value);
      const output = document.getElementById("output");
      output.innerHTML = "";

      // æ–¹æ¡ˆAï¼šæ–°æœƒå“¡å–®äººå…¥ä½
      let hcNeededA = hafhHC, hcStartA = 300, hcDiffA = hcNeededA - hcStartA;
      let minA = hcDiffA > 0 ? getMinCostPackage(hcDiffA) : { packMap: {}, total: 0 };
      let itemsA = Object.entries(minA.packMap).map(([k, v]) => `${k} Ã—${v}ï¼ˆ${formatCurrency(
        packs.find(p=>p.label===k).cost * v
      )}ï¼‰`).join('ï¼‹');
      let totalA = 439 + minA.total;
      let discountA = getDiscount(totalA, officialPrice);

      // æ–¹æ¡ˆBï¼šæ–°æœƒå“¡é›™äººå…¥ä½åˆ†æ”¤
      let hcEachB = Math.ceil(hafhHC / 2);
      let hcDiffB = hcEachB - 300;
      let minB = hcDiffB > 0 ? getMinCostPackage(hcDiffB) : { packMap: {}, total: 0 };
      let itemsB = Object.entries(minB.packMap).map(([k, v]) => `${k} Ã—${v}ï¼ˆ${formatCurrency(
        packs.find(p=>p.label===k).cost * v
      )}ï¼‰`).join('ï¼‹');
      let totalEachB = 439 + minB.total;
      let totalCostB = totalEachB * 2;
      let discountB = getDiscount(totalCostB, officialPrice);

      // æ–¹æ¡ˆCï¼šèˆŠæœƒå“¡é‚€è«‹æœ‹å‹ä¸€èµ·ä½
      // èˆŠæœƒå“¡ç«¯éœ€åŠ è³¼ï¼Œéœ€ cover åˆ†æ”¤å¾Œ â’½ æ•¸ï¼ˆç”¨æŒ‡å®šçµ„åˆç®—å‡ºè¶³å¤ çµ„æ•¸ï¼‰
      let hcEachC = hcEachB; // èˆŠæœƒå“¡èˆ‡æœ‹å‹å„éœ€
      let oldNeed = hcEachC;
      let oldBuy = Math.ceil(oldNeed / 200); // å¹¾çµ„ 200 â’½
      let oldCostC = oldBuy * 1440;

      // æœ‹å‹éœ€è£œå·®é¡
      let friendDiffC = hcEachC - 300;
      let minC = friendDiffC > 0 ? getMinCostPackage(friendDiffC) : { packMap: {}, total: 0 };
      let itemsC = Object.entries(minC.packMap).map(([k, v]) => `${k} Ã—${v}ï¼ˆ${formatCurrency(
        packs.find(p=>p.label===k).cost * v
      )}ï¼‰`).join('ï¼‹');
      let totalC = oldCostC + 439 + minC.total;
      let discountC = getDiscount(totalC, officialPrice);

      // é¡¯ç¤ºæ–°æ‰‹åŒ…çµ„åˆ
      let packInfo = `<div class="pack-info">
        <strong>HafH æ–°æ‰‹åŒ…èˆ‡æŒ‡å®šä»£å¹£çµ„åˆåƒ¹æ ¼ï¼š</strong><br>
        æ–°æ‰‹åŒ…ï¼š100 â’½ï¼NT$720ã€300 â’½ï¼NT$2,040ã€600 â’½ï¼NT$3,840ï¼ˆå„é™è³¼ä¸€æ¬¡ï¼Œåƒ…é™æ–°æœƒå“¡é¦–æ¬¡è¨»å†Šè³¼è²·ï¼‰<br>
        æŒ‡å®šä»£å¹£çµ„åˆï¼š200 â’½ï¼NT$1,440ï¼ˆä¸é™æ¬¡æ•¸ï¼Œåƒ…é™ä»˜è²»æœƒå“¡è³¼è²·ï¼‰
      </div>`;

      let html = packInfo;

      html += `<div class="result"><h2>æ–¹æ¡ˆ Aï½œæ–°æœƒå“¡å–®äººå…¥ä½</h2>
      <ul>
        <li>å¸³è™Ÿé–‹å±€ç‚º 300 â’½ï¼Œå¯¦éš›éœ€è¦ ${hcNeededA} â’½ï¼Œå·®é¡ ${hcDiffA > 0 ? hcDiffA : 0} â’½</li>
        ${hcDiffA > 0 ? `<li>åŠ è³¼ä»£å¹£çµ„åˆï¼š${itemsA}</li>` : ''}
        <li>é¦–æœˆæœƒè²»ï¼š${formatCurrency(439)}</li>
      </ul>
      <div class="cost">ç¸½æˆæœ¬ï¼šç´„ ${formatCurrency(totalA)}</div>
      <div class="highlight">ğŸ“‰ ${discountA}</div>
      </div>`;

      html += `<div class="result"><h2>æ–¹æ¡ˆ Bï½œæ–°æœƒå“¡é›™äººå…¥ä½åˆ†æ”¤</h2>
      <ul>
        <li>æˆ¿åƒ¹ ${hafhHC} â’½ æ‹†åŠå¾Œæ¯äººéœ€ ${hcEachB} â’½ï¼Œå¸³è™Ÿé–‹å±€ 300 â’½ï¼Œå·®é¡ ${hcDiffB > 0 ? hcDiffB : 0} â’½ï¼äºº</li>
        ${hcDiffB > 0 ? `<li>æ¯äººåŠ è³¼ä»£å¹£çµ„åˆï¼š${itemsB}</li>` : ''}
        <li>é¦–æœˆæœƒè²»ï¼š${formatCurrency(439)}ï¼äºº</li>
      </ul>
      <div class="cost">ç¸½æˆæœ¬ï¼šç´„ ${formatCurrency(totalCostB)}ï¼ˆ${formatCurrency(totalEachB)}ï¼äººï¼‰</div>
      <div class="highlight">ğŸ“‰ ${discountB}</div>
      </div>`;

      html += `<div class="result"><h2>æ–¹æ¡ˆ Cï½œèˆŠæœƒå“¡é‚€è«‹æœ‹å‹ä¸€èµ·ä½</h2>
      <ul>
        <li>èˆŠæœƒå“¡èˆ‡æœ‹å‹å„éœ€ ${hcEachC} â’½ï¼ŒèˆŠæœƒå“¡å…¨é¡åŠ è³¼ï¼ˆæŒ‡å®šä»£å¹£çµ„åˆ 200 â’½ Ã—${oldBuy}ï¼Œ${formatCurrency(oldCostC)}ï¼‰</li>
        <li>æœ‹å‹é¦–æ¬¡åŠ å…¥æœˆè²»ï¼š${formatCurrency(439)}</li>
        ${friendDiffC > 0 ? `<li>æœ‹å‹åŠ è³¼ä»£å¹£çµ„åˆï¼š${itemsC}</li>` : ''}
      </ul>
      <div class="cost">ç¸½æˆæœ¬ï¼šç´„ ${formatCurrency(totalC)}</div>
      <div class="highlight">ğŸ“‰ ${discountC}</div>
      </div>`;

      html += `<div class="footer"><strong>æº«é¦¨æé†’ï¼š</strong><br>
        1. æ­¤è©¦ç®—é é¢ç‚ºç²—ç•¥ä¼°ç®—ï¼Œç‚ºæ±‚è¬¹æ…è«‹è‡ªè¡Œä¾ç…§é‚è¼¯å†æ¬¡è©¦ç®—ä¸€éã€‚<br>
        2. ä»˜è²»åŠ å…¥ç•¶å¤©ç‚ºçµç®—æ—¥ï¼Œä¸”ç‚ºç¬¬ä¸€æ¬¡æ‰£æ¬¾ã€‚åˆ°ç¬¬ä¸‰æ¬¡æ‰£æ¬¾æ™‚å¸³è™Ÿæœƒå‡ç´šç‚º Silver VIPï¼Œäº«æœ‰æ¯ç­†è¨‚æˆ¿ 95 æŠ˜ã€‚<br>
        3. æœ‰é ç´„çš„ç‹€æ³ä¸‹ç„¡æ³•è®Šæ›´ç‚ºä¼‘çœ æœƒç±ï¼Œè‹¥é ç´„æ—¥æœŸè·é›¢ç¾åœ¨é‚„æœƒç¶“éä¸€æ¬¡çµç®—æ—¥ï¼Œå‰‡æœƒæœ‰æ‰£æ¬¾ä¸¦åŒæ™‚æœ‰ 200 â’½ å…¥å¸³ã€‚
      </div>`;
      output.innerHTML = html;
    }
  </script>
</head>
<body>
  <h1>HafH 2025 é¦–æœˆ 3 æŠ˜æ´»å‹•è¨ˆç®—æ©Ÿ</h1>
  <div class="intro">
    <b>æé†’ï¼š</b>æ–°æœƒå“¡é è¨­å¸³æˆ¶æœ‰ 300 â’½ï¼Œæ‰€æœ‰è¨ˆç®—ä»¥æ­¤ç‚ºå‰æã€‚è«‹å¡«å¯«ç¬¦åˆç›¸åŒæ¢ä»¶ï¼ˆæ—¥æœŸã€äººæ•¸ã€å–æ¶ˆè¦å‰‡ï¼‰ä¸”ç‚ºæ–°å°å¹£çš„é‡‘é¡ã€‚
  </div>
  <label>HafH æ‰€éœ€ â’½ æ•¸ï¼š</label>
  <input id="hafhHC" type="number" value="750">
  <label>å®˜ç¶²åƒ¹æ ¼ï¼ˆNT$ï¼‰ï¼š</label>
  <input id="officialPrice" type="number" value="4400">
  <button onclick="showResult()">è¨ˆç®—</button>
  <div id="output"></div>
</body>
</html>
