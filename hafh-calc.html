<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>HafH 2025 首月 3 折活動計算機</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Noto Sans TC', 'Segoe UI', Arial, 'Microsoft JhengHei', sans-serif;
      background: #fcfcfc;
      color: #232323;
      margin: 0;
    }
    .main {
      max-width: 650px;
      margin: 0 auto;
      padding: 16px 8px 56px 8px;
      text-align: center;
    }
    h1 {
      font-size: 2.6em;
      font-weight: 900;
      margin: 32px 0 8px 0;
      letter-spacing: 2px;
    }
    .sub-title {
      font-size: 1.15em;
      color: #222;
      font-weight: 700;
      line-height: 1.7;
      margin-bottom: 8px;
    }
    .sub-title .thin {
      font-weight: 400;
      display: block;
      font-size: 1em;
      margin-top: 8px;
    }
    .desc {
      margin: 8px auto 24px auto;
      font-size: 1em;
      color: #444;
      line-height: 1.65;
      font-weight: 400;
      max-width: 460px;
    }
    .pack-table {
      display: flex;
      justify-content: center;
      gap: 48px;
      padding: 28px 0 12px 0;
      max-width: 650px;
      margin: 0 auto;
      border-radius: 18px;
      background: #fff;
      box-shadow: 0 4px 24px #0001;
    }
    .pack-col {
      min-width: 170px;
      text-align: left;
    }
    .pack-title {
      font-weight: 700;
      font-size: 1.08em;
      letter-spacing: 1px;
      margin-bottom: 7px;
    }
    .pack-list td {
      padding: 2px 8px 2px 0;
      font-size: 1.09em;
    }
    .pack-note {
      font-size: 0.97em;
      color: #b47b00;
      margin-top: 4px;
      font-weight: 400;
    }
    .pack-note2 {
      font-size: 0.97em;
      color: #237a20;
      margin-top: 4px;
      font-weight: 400;
    }
    .input-card {
      background: #fff;
      margin: 36px auto 18px auto;
      padding: 22px 24px 18px 24px;
      max-width: 340px;
      border-radius: 16px;
      box-shadow: 0 3px 24px #0001;
    }
    .input-card label {
      font-size: 1.09em;
      font-weight: 700;
      display: block;
      text-align: left;
      margin-bottom: 2px;
      margin-top: 16px;
    }
    .input-card input[type="number"] {
      width: 94%;
      font-size: 1em;
      padding: 8px;
      border: 1px solid #bbb;
      border-radius: 8px;
      outline: none;
      background: #f6f6f6;
      margin-bottom: 5px;
      margin-top: 2px;
      color: #333;
      box-sizing: border-box;
    }
    .input-card input[type="number"]::placeholder {
      color: #aaa;
      font-size: 1em;
      font-weight: 400;
      opacity: 1;
    }
    .input-card button {
      background: #1bb24e;
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 1.16em;
      font-weight: 700;
      padding: 10px 0;
      width: 100%;
      margin-top: 20px;
      cursor: pointer;
      transition: background .15s;
    }
    .input-card button:hover { background: #12853a; }
    #output {
      margin: 26px auto 0 auto;
      max-width: 650px;
      text-align: center;
    }
    .result-block {
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 2px 12px #0001;
      margin: 28px auto;
      padding: 22px 32px 20px 32px;
      text-align: left;
      max-width: 530px;
      min-width: 0;
    }
    .result-block h2 {
      font-size: 1.4em;
      font-weight: 900;
      margin: 0 0 10px 0;
      letter-spacing: 1px;
      color: #111;
      line-height: 1.3;
    }
    .result-block ul {
      margin: 0 0 13px 0;
      padding-left: 1.2em;
      font-size: 1.07em;
      line-height: 1.7;
    }
    .result-summary {
      background: #fcfaf6;
      border: 2px solid #ffaa32;
      border-radius: 12px;
      margin: 22px 0 0 0;
      padding: 14px 14px 8px 14px;
      display: flex;
      flex-direction: row;
      align-items: flex-end;
      justify-content: space-between;
      gap: 2em;
    }
    .result-sum-txt {
      text-align: left;
    }
    .result-label {
      color: #333;
      font-size: 1em;
      font-weight: 500;
      margin: 0 0 4px 0;
    }
    .result-cost {
      font-size: 2.1em;
      font-weight: 900;
      color: #222;
      letter-spacing: 1px;
      margin-bottom: 2px;
    }
    .summary-note {
      font-size: 1.1em;
      color: #1976d2;
      font-weight: 700;
      text-align: right;
      margin-bottom: 0.4em;
      margin-left: 2em;
      margin-top: 0.5em;
    }
    .footer-note {
      background: #fff;
      margin: 44px auto 0 auto;
      max-width: 640px;
      border-radius: 14px;
      box-shadow: 0 3px 18px #0001;
      padding: 20px 18px 18px 30px;
      color: #555;
      font-size: 1.01em;
      text-align: left;
      line-height: 1.8;
    }
    @media (max-width: 700px) {
      .main { padding: 10px 2vw 50px 2vw;}
      .pack-table { flex-direction: column; gap: 0; padding: 18px 0 5px 0;}
      .input-card { padding: 18px 7vw 16px 7vw;}
      .result-block { padding: 18px 4vw 15px 4vw; }
      .footer-note { padding: 15px 8px 15px 14px;}
    }
  </style>
</head>
<body>
  <div class="main">
    <h1>HafH 2025 首月 3 折活動計算機</h1>
    <div class="sub-title">
      <b>提醒：</b>新會員預設帳戶有 300 Ⓗ，所有計算以此為前提。<br>
      <span class="thin">
        請填寫符合相同條件（日期、人數、取消規則）<br>且為新台幣的金額。
      </span>
    </div>
    <div class="pack-table">
      <div class="pack-col">
        <div class="pack-title">新手包（限新會員首次註冊，各組限購 1 次）</div>
        <table class="pack-list">
          <tr><td>100 Ⓗ</td><td>NT$720</td></tr>
          <tr><td>300 Ⓗ</td><td>NT$2,040</td></tr>
          <tr><td>600 Ⓗ</td><td>NT$3,840</td></tr>
        </table>
        <div class="pack-note">新手包僅在新會員註冊時可購買，各組限購一次。</div>
      </div>
      <div class="pack-col">
        <div class="pack-title">指定代幣組合（不限次數，付費會員皆可購買）</div>
        <table class="pack-list">
          <tr><td>200 Ⓗ</td><td>NT$1,440</td></tr>
        </table>
        <div class="pack-note2">指定代幣組合購買無上限，會員期間隨時可購買。</div>
      </div>
    </div>
    <div class="input-card">
      <label>HafH 所需 Ⓗ 數：</label>
      <input id="hafhHC" type="number" placeholder="例：430">
      <label>官網價格（NT$）：</label>
      <input id="officialPrice" type="number" placeholder="例：4400">
      <button onclick="showResult()">計算</button>
    </div>
    <div id="output"></div>
    <div class="footer-note">
      1. 此試算頁面為粗略估算，為求謹慎請自行依照機制再多次試算一遍。<br>
      2. 付費加入當天為結算日，且為第一次扣款。到第三次扣款時帳號會升級為 Silver VIP，享有每筆訂房 95 折。<br>
      3. 有預約的狀況下無法變更為休眠會籍。若有跨月則需考慮結算日。即有扣款同時有 200 Ⓗ 入帳。
    </div>
  </div>
  <script>
    // 新手包組合與指定代幣組合設定
    const starterPacks = [
      { qty: 600, price: 3840 },
      { qty: 300, price: 2040 },
      { qty: 100, price: 720 }
    ];
    const regularPack = { qty: 200, price: 1440 };

    function format(num) {
      return "NT$" + num.toLocaleString();
    }
    function formatPercent(num) {
      return (num*100).toFixed(1) + "%";
    }
    function formatFold(num) {
      let n = Math.round(num*10)/10;
      if (n >= 1) return "約為官網價格 " + n + " 折";
      return "約為官網價格 " + (num*100).toFixed(0) + "%";
    }

    // 動態組合找最小金額（回傳：[{qty, price, type, count}]）
    function getTokenPurchasePlan(diff) {
      let remain = diff;
      let plan = [];
      let pack = null;
      // 先消耗 starterPack（各限購1組），由大到小
      for (let i=0; i<starterPacks.length; ++i) {
        let used = 0;
        let sp = starterPacks[i];
        if (remain >= sp.qty) {
          used = Math.min(1, Math.floor(remain / sp.qty));
          remain -= sp.qty * used;
          if (used > 0) plan.push({type:'starter', qty:sp.qty, price:sp.price, count:used});
        }
      }
      // 剩下不足 starterPack 的部分用 regularPack 補
      if (remain > 0) {
        let need = Math.ceil(remain / regularPack.qty);
        plan.push({type:'regular', qty:regularPack.qty, price:regularPack.price, count:need});
        remain = 0;
      }
      return plan;
    }

    // 方案計算
    function showResult() {
      const hafhHC = parseInt(document.getElementById('hafhHC').value, 10);
      const officialPrice = parseInt(document.getElementById('officialPrice').value, 10);
      if (isNaN(hafhHC) || isNaN(officialPrice) || hafhHC <= 0 || officialPrice <= 0) {
        document.getElementById('output').innerHTML = '<div style="color:#d00;padding:1.5em 0;font-weight:bold;">請正確輸入所需 HafH 代幣與官網價格</div>';
        return;
      }

      // 方案 A：一人申辦新會員
      let diffA = Math.max(0, hafhHC - 300);
      let purchaseA = getTokenPurchasePlan(diffA);
      let totalCostA = 439; // 會費
      let purchaseStrA = "";
      if (purchaseA.length > 0) {
        purchaseStrA = purchaseA.map(p => {
          return (p.type==='starter' ? "新手包 " : "指定代幣組合 ") + p.qty + " Ⓗ ×" + p.count + "（" + format(p.price * p.count) + "）";
        }).join("<br>");
        totalCostA += purchaseA.reduce((sum, p) => sum + p.price * p.count, 0);
      }
      let percentA = totalCostA / officialPrice;
      let percentStrA = "與您提供的官網價格相比約為 " + formatPercent(percentA) + "（" + formatFold(percentA) + "）";

      // 方案 B：兩人同時申辦新會員
      let perPerson = Math.ceil(hafhHC/2);
      let diffB = Math.max(0, perPerson - 300);
      let purchaseB = getTokenPurchasePlan(diffB);
      let totalCostB = 439*2;
      let purchaseStrB = "";
      if (purchaseB.length > 0) {
        purchaseStrB = purchaseB.map(p => {
          return (p.type==='starter' ? "新手包 " : "指定代幣組合 ") + p.qty + " Ⓗ ×" + p.count + "（" + format(p.price * p.count) + "）";
        }).join("<br>");
        totalCostB += purchaseB.reduce((sum, p) => sum + p.price * p.count, 0) * 2; // 兩人
      }
      let percentB = totalCostB / officialPrice;
      let percentStrB = "與您提供的官網價格相比約為 " + formatPercent(percentB) + "（" + formatFold(percentB) + "）";

      // 方案 C：舊會員邀請朋友一起住
      let diffC1 = perPerson; // 舊會員需要的全部代幣
      let purchaseC1 = getTokenPurchasePlan(diffC1);
      let totalCostC1 = purchaseC1.reduce((sum, p) => sum + p.price * p.count, 0);
      let purchaseStrC1 = purchaseC1.map(p =>
        (p.type==='starter' ? "新手包 " : "指定代幣組合 ") + p.qty + " Ⓗ ×" + p.count + "（" + format(p.price * p.count) + "）"
      ).join("<br>");
      let totalCostC = totalCostC1 + 439;
      let percentC = totalCostC / officialPrice;
      let percentStrC = "與您提供的官網價格相比約為 " + formatPercent(percentC) + "（" + formatFold(percentC) + "）";

      // 組裝區塊
      let html = '';

      // 方案 A
      html += `
      <div class="result-block">
        <h2>方案 A｜一人申辦新會員</h2>
        <ul>
          <li>帳號開局為 300 Ⓗ<br>實際需要 ${hafhHC} Ⓗ<br>差額 ${diffA} Ⓗ</li>
          <li>加購代幣組合：<br>${purchaseStrA ? purchaseStrA : "—"}</li>
          <li>首月會費：${format(439)}</li>
        </ul>
        <div class="result-summary">
          <div class="result-sum-txt">
            <div class="result-label">總成本：</div>
            <div class="result-cost">${format(totalCostA)}</div>
            <div class="result-label">官網價格：</div>
            <div class="result-cost">${format(officialPrice)}</div>
          </div>
          <div class="summary-note">${percentStrA}</div>
        </div>
      </div>
      `;

      // 方案 B
      html += `
      <div class="result-block">
        <h2>方案 B｜兩人同時申辦新會員（分攤預訂）</h2>
        <ul>
          <li>房價 ${hafhHC} Ⓗ 拆半後每人需 ${perPerson} Ⓗ<br>帳號開局 300 Ⓗ，差額 ${diffB} Ⓗ /人</li>
          <li>每人加購代幣組合：<br>${purchaseStrB ? purchaseStrB : "—"}</li>
          <li>每人首月會費：${format(439)}</li>
        </ul>
        <div class="result-summary">
          <div class="result-sum-txt">
            <div class="result-label">總成本：</div>
            <div class="result-cost">${format(totalCostB)}</div>
            <div class="result-label">官網價格：</div>
            <div class="result-cost">${format(officialPrice)}</div>
          </div>
          <div class="summary-note">${percentStrB}</div>
        </div>
      </div>
      `;

      // 方案 C
      html += `
      <div class="result-block">
        <h2>方案 C｜舊會員邀請朋友一起住</h2>
        <ul>
          <li>舊會員與朋友各需 ${perPerson} Ⓗ<br>舊會員全額加購<br>${purchaseStrC1 ? purchaseStrC1 : "—"}</li>
          <li>朋友首次加入月費：${format(439)}</li>
        </ul>
        <div class="result-summary">
          <div class="result-sum-txt">
            <div class="result-label">總成本：</div>
            <div class="result-cost">${format(totalCostC)}</div>
            <div class="result-label">官網價格：</div>
            <div class="result-cost">${format(officialPrice)}</div>
          </div>
          <div class="summary-note">${percentStrC}</div>
        </div>
      </div>
      `;

      document.getElementById('output').innerHTML = html;
    }
  </script>
</body>
</html>
